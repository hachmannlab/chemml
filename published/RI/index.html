<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Accelerated Discovery of High-Refractive-Index Molecules &mdash; ChemML  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="ChemML API" href="../../API/index.html" />
    <link rel="prev" title="Published" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            ChemML
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">ChemML Library</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../chemml_library.html">Introduction to ChemML Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../input_task/index.html">Input</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../represent_task/index.html">Represent</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../prepare_task/index.html">Prepare</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../model_task/index.html">Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../optimize_task/index.html">Optimize</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../explain_task/index.html">Explain</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../visualize_task/index.html">Visualize</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ChemML Wrapper</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../chemml_wrapper.html">Introduction to ChemML Wrapper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../wrapper/index.html">ChemML Wrapper Tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Published Models</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Published</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Accelerated Discovery of High-Refractive-Index Molecules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#single-target-dnns">Single Target DNNs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#physics-infused-dnn">Physics Infused DNN</a></li>
<li class="toctree-l3"><a class="reference internal" href="#transfer-learning-tzvp-polarizabilities">Transfer learning TZVP Polarizabilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="#citation">Citation</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ChemML API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../API/index.html">ChemML API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ChemML</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Published</a></li>
      <li class="breadcrumb-item active">Accelerated Discovery of High-Refractive-Index Molecules</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/published/RI/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="accelerated-discovery-of-high-refractive-index-molecules">
<h1>Accelerated Discovery of High-Refractive-Index Molecules<a class="headerlink" href="#accelerated-discovery-of-high-refractive-index-molecules" title="Permalink to this heading"></a></h1>
<p>We present a high-throughput computational study to identify novel polyimides (PIs) with exceptional refractive index (RI) values for use as optic or optoelectronic materials. Our study utilizes an RI prediction protocol based on a combination of first-principles and data modeling developed in previous work, which we employ on a large-scale PI candidate library generated with the ChemLG code. We deploy the virtual screening software ChemHTPS to automate the assessment of this extensive pool of PI structures in order to determine the performance potential of each candidate. This rapid and efficient approach yields a number of highly promising leads compounds. Using the data mining and machine learning program package ChemML, we analyze the top candidates with respect to prevalent structural features and feature combinations that distinguish them from less promising ones. In particular, we explore the utility of various strategies that introduce highly polarizable moieties into the PI backbone to increase its RI yield. The derived insights provide a foundation for rational and targeted design that goes beyond traditional trial-and-error searches.</p>
<p>For this study, we created a library of 1.5 million small organic molecules using an initial set of 15 building blocks (and constraints on molecular weight and number of ring-moieties per molecule) via ChemLG.</p>
<p>We select a random subset of 100,000 molecules from this library and perform high-throughput electronic structure theory calculations to obtain Polarizability using the Kohn-Sham density functional theory (DFT). For these molecules, the initial geometries are generated using the MMFF94s forcefield (from Openbabel software), and are subsequently optimized using BP86 generalized gradient approximation (GGA) functional with the double-<span class="math notranslate nohighlight">\({\zeta}\)</span> basis set by the Karslruhe group. In order to calculate Polarizability, we then perform single point energy calculations using an all-electron restricted DFT framework with the PBE0 hybrid functional and the same double-<span class="math notranslate nohighlight">\({\zeta}\)</span> def2-SVP basis set along with Grimme’s D3 correction to account for dispersion interactions.</p>
<p>Since RI is to be estimated from pol, we additionally use a larger and more accurate triple-<span class="math notranslate nohighlight">\({\zeta}\)</span> def2-TZVP basis set from the Karlsruhe group for Polarizability. However, considering the computational overhead of these extra calculations at higher levels of quantum theory, we only use the triple-<span class="math notranslate nohighlight">\({\zeta}\)</span> basis set for a random subset of 10,000 molecules from the 100,000 molecules considered for DFT. All our DFT calculations are carried out using the ORCA 3.0.2 quantum chemistry program package cite{Neese2012} with default settings. By default, these ORCA calculations yield polarizability volume or pol’ in <span class="math notranslate nohighlight">\({Bohr^3}\)</span>. For the purposes of this chapter, the def2-SVP and def2-TZVP basis sets and corresponding datasets are abbreviated to SVP and TZVP.</p>
<p>Next, we calculate RI using these Polarizability values and Number Density (obtained from molecular dynamics simulations) and the resulting dataset serves as the ground-truth for our data modeling efforts. In order to accelerate screening of the remainder of the molecules in the library, we develop highly acccurate ML surrogates for predicting Polarizability, RI, and Number Density. In this pursuit, we use a variety of advanced deep neural network (DNN) architectures as they are promising for their performance and flexibility. We benchmark and compare these models and outline some of their strengths and weaknesses in the process.</p>
<p>For all ML models, we use two families of feature representations:</p>
<blockquote>
<div><ul class="simple">
<li><p>Molecular descriptors: 1893 two-dimensional topological and physicochemical descriptors from Dragon 7 software</p></li>
<li><p>Molecular fingerprints (FP): Three sets of molecular graph based FP vectors (each of length 1024 bits) from RDKit – Morgan FP with circular radius 2, hashed atom pair FP (HAP), hashed topological torsion FP (HTT)</p></li>
</ul>
</div></blockquote>
<p>A train-test split of 9:1 is used to fit the data to the DNNs with additional parameters for early stopping, dropout, and l2 regularization parameter to avoid overfitting. ChemML’s genetic algorithm implementation is used to optimize the hyperparameters, such as the regularization parameter, number of neurons and hidden layers, learning rate, etc., that dictate the architecture as well as the training of DNNs. . For assessing the ML model’s performance, we report the following regression metrics : mean absolute error (MAE), root mean squared error (RMSE), mean absolute percentage error (MAPE), and the coefficient of determination <span class="math notranslate nohighlight">\({R^2}\)</span>.</p>
<section id="single-target-dnns">
<h2>Single Target DNNs<a class="headerlink" href="#single-target-dnns" title="Permalink to this heading"></a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># load SMILES representation and target properties of 100,000 molecules</span>
<span class="kn">from</span> <span class="nn">chemml.published.RI</span> <span class="kn">import</span> <span class="n">load_small_organic_data</span><span class="p">()</span>

<span class="n">molecules</span><span class="p">,</span> <span class="n">targets</span> <span class="o">=</span> <span class="n">load_small_organic_data</span><span class="p">()</span>


<span class="c1"># convert the SMILES representation of molecules to chemml.chem.Molecule object</span>
<span class="kn">from</span> <span class="nn">chemml.chem</span> <span class="kn">import</span> <span class="n">Molecule</span>

<span class="n">mol_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">Molecule</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="s1">&#39;smiles&#39;</span><span class="p">],</span> <span class="s1">&#39;smiles&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">molecules</span><span class="p">]</span>


<span class="c1"># generate Morgan, HAP and HTT fingerprints</span>
<span class="kn">from</span> <span class="nn">chemml.chem</span> <span class="kn">import</span> <span class="n">RDKitFingerprint</span>

<span class="n">morgan</span> <span class="o">=</span> <span class="n">RDKitFingerprint</span><span class="p">(</span><span class="n">fingerprint_type</span><span class="o">=</span><span class="s1">&#39;morgan&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">represent</span><span class="p">(</span><span class="n">mol_list</span><span class="p">)</span>
<span class="n">hap</span> <span class="o">=</span> <span class="n">RDKitFingerprint</span><span class="p">(</span><span class="n">fingerprint_type</span><span class="o">=</span><span class="s1">&#39;hap&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">represent</span><span class="p">(</span><span class="n">mol_list</span><span class="p">)</span>
<span class="n">htt</span> <span class="o">=</span> <span class="n">RDKitFingerprint</span><span class="p">(</span><span class="n">fingerprint_type</span><span class="o">=</span><span class="s1">&#39;htt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">represent</span><span class="p">(</span><span class="n">mol_list</span><span class="p">)</span>


<span class="c1"># generate Dragon descriptors</span>
<span class="kn">from</span> <span class="nn">chemml.chem</span> <span class="kn">import</span> <span class="n">Dragon</span>

<span class="n">dragon</span> <span class="o">=</span> <span class="n">Dragon</span><span class="p">()</span><span class="o">.</span><span class="n">represent</span><span class="p">(</span><span class="n">mol_list</span><span class="p">)</span>


<span class="n">feature_sets</span> <span class="o">=</span> <span class="p">[</span><span class="n">dragon</span><span class="p">,</span> <span class="n">morgan</span><span class="p">,</span> <span class="n">hap</span><span class="p">,</span> <span class="n">htt</span><span class="p">]</span>
<span class="n">targets</span> <span class="o">=</span> <span class="p">[</span><span class="n">targets</span><span class="p">[</span><span class="s1">&#39;refractive_index&#39;</span><span class="p">],</span> <span class="n">targets</span><span class="p">[</span><span class="s1">&#39;polarizability&#39;</span><span class="p">],</span> <span class="n">targets</span><span class="p">[</span><span class="s1">&#39;number_density&#39;</span><span class="p">]]</span>


<span class="c1"># generate indices for splitting the features and targets into training and test sets</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">train_indices</span><span class="p">,</span> <span class="n">test_indices</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100000</span><span class="p">),</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>

<span class="c1"># Model Training</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">chemml.utils</span> <span class="kn">import</span> <span class="n">regression_metrics</span>
<span class="kn">from</span> <span class="nn">chemml.models</span> <span class="kn">import</span> <span class="n">MLP</span>
<span class="kn">from</span> <span class="nn">chemml.published.RI</span> <span class="kn">import</span> <span class="n">load_hyperparameters</span>


<span class="k">for</span> <span class="n">f</span><span class="p">,</span> <span class="n">f_name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">feature_sets</span><span class="p">,[</span><span class="s1">&#39;dragon&#39;</span><span class="p">,</span> <span class="s1">&#39;morgan&#39;</span><span class="p">,</span> <span class="s1">&#39;hap&#39;</span><span class="p">,</span> <span class="s1">&#39;htt&#39;</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">t</span><span class="p">,</span> <span class="n">t_name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;refractive_index&#39;</span><span class="p">,</span> <span class="s1">&#39;polarizability&#39;</span><span class="p">,</span> <span class="s1">&#39;number_density&#39;</span><span class="p">]):</span>

        <span class="c1"># scalers for features and targets</span>
        <span class="n">xscale</span><span class="p">,</span> <span class="n">yscale</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">(),</span> <span class="n">StandardScaler</span><span class="p">()</span>

        <span class="c1"># initialize a neural network object</span>
        <span class="n">mlp</span> <span class="o">=</span> <span class="n">MLP</span><span class="p">()</span>


        <span class="c1"># load optimized hyperparameters into MLP object</span>
        <span class="n">mlp</span> <span class="o">=</span> <span class="n">load_hyperparameters</span><span class="p">(</span><span class="n">mlp</span><span class="p">,</span> <span class="n">f_name</span><span class="p">,</span> <span class="n">t_name</span><span class="p">,</span> <span class="s1">&#39;single&#39;</span><span class="p">)</span>

        <span class="c1"># model fitting</span>
        <span class="n">mlp</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span> <span class="o">=</span> <span class="n">xscale</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">train_indices</span><span class="p">]),</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">yscale</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">train_indices</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>

        <span class="c1"># model predictions on test data</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="n">yscale</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">mlp</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">xscale</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">test_indices</span><span class="p">])))</span>
        <span class="n">metrics_df</span> <span class="o">=</span> <span class="n">regression_metrics</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">test_indices</span><span class="p">],</span> <span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="physics-infused-dnn">
<h2>Physics Infused DNN<a class="headerlink" href="#physics-infused-dnn" title="Permalink to this heading"></a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">chemml.published.RI</span> <span class="kn">import</span> <span class="n">LorentzLorenz</span>

<span class="c1"># instantiate LorentzLorenz() class object</span>
<span class="n">physics_infused_model</span> <span class="o">=</span> <span class="n">LorentzLorenz</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># process input data according to the format required for this class</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">scaler_y</span> <span class="o">=</span> <span class="n">physics_infused_model</span><span class="o">.</span><span class="n">preprocessing</span><span class="p">(</span>
                                        <span class="n">features</span><span class="o">=</span><span class="n">feature_sets</span><span class="p">,</span> <span class="n">targets</span><span class="o">=</span><span class="n">targets</span><span class="p">,</span> <span class="n">return_scaler</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># fit the model to training data</span>
<span class="n">physics_infused_model</span> <span class="o">=</span> <span class="n">physics_infused_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># get predictions on test data</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">physics_infused_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="transfer-learning-tzvp-polarizabilities">
<h2>Transfer learning TZVP Polarizabilities<a class="headerlink" href="#transfer-learning-tzvp-polarizabilities" title="Permalink to this heading"></a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># load TZVP data</span>
<span class="kn">from</span> <span class="nn">chemml.published.RI</span> <span class="kn">import</span> <span class="n">load_small_organic_data_10k</span>

<span class="n">molecules</span><span class="p">,</span> <span class="n">targets</span> <span class="o">=</span> <span class="n">load_small_organic_data_10k</span><span class="p">()</span>


<span class="c1"># convert the SMILES representation of molecules to chemml.chem.Molecule object</span>
<span class="n">mol_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">Molecule</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;smiles&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">molecules</span><span class="p">]</span>

<span class="c1"># generate Dragon descriptors</span>
<span class="n">dragon_tzvp</span> <span class="o">=</span> <span class="n">Dragon</span><span class="p">()</span><span class="o">.</span><span class="n">represent</span><span class="p">(</span><span class="n">mol_list</span><span class="p">)</span>

<span class="c1"># generate indices for splitting the features and targets into training and test sets</span>
<span class="n">train_indices</span><span class="p">,</span> <span class="n">test_indices</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10000</span><span class="p">),</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>

<span class="c1"># initialize a ChemML MLP object</span>
<span class="n">tzvp_model</span> <span class="o">=</span> <span class="n">MLP</span><span class="p">()</span>

<span class="c1"># load optimized hyperparameters into MLP object</span>
<span class="n">tzvp_model</span> <span class="o">=</span> <span class="n">load_hyperparameters</span><span class="p">(</span><span class="n">tzvp_model</span><span class="p">,</span> <span class="s1">&#39;dragon&#39;</span><span class="p">,</span> <span class="s1">&#39;polarizability&#39;</span><span class="p">,</span> <span class="s1">&#39;transfer_learning&#39;</span><span class="p">)</span>

<span class="c1"># initialize a ChemML MLP object</span>
<span class="n">mlp</span> <span class="o">=</span> <span class="n">MLP</span><span class="p">()</span>

<span class="c1"># load pre-trained ML model in the object</span>
<span class="kn">from</span> <span class="nn">chemml.published.RI</span> <span class="kn">import</span> <span class="n">load_model</span>

<span class="n">svp_model</span> <span class="o">=</span> <span class="n">mlp</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">load_model</span><span class="p">(</span><span class="s1">&#39;dragon&#39;</span><span class="p">,</span> <span class="s1">&#39;polarizability&#39;</span><span class="p">))</span>

<span class="c1"># initialize a TransferLearning object</span>
<span class="kn">from</span> <span class="nn">chemml.models</span> <span class="kn">import</span> <span class="n">TransferLearning</span>

<span class="n">tl</span> <span class="o">=</span> <span class="n">TransferLearning</span><span class="p">(</span><span class="n">base_model</span><span class="o">=</span><span class="n">svp_model</span><span class="p">)</span>

<span class="c1"># transfer the hidden layers from SVP model to TZVP model and fit the model to the new data</span>
<span class="n">combined_model</span> <span class="o">=</span> <span class="n">tl</span><span class="o">.</span><span class="n">transfer</span><span class="p">(</span><span class="n">dragon_tzvp</span><span class="p">[</span><span class="n">train_indices</span><span class="p">],</span> <span class="n">targets</span><span class="p">[</span><span class="n">train_indices</span><span class="p">],</span> <span class="n">tzvp_model</span><span class="p">)</span>

<span class="c1"># predictions on test set</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">combined_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">dragon_tzvp</span><span class="p">[</span><span class="n">test_indices</span><span class="p">])</span>
<span class="n">metrics_df</span> <span class="o">=</span> <span class="n">regression_metrics</span><span class="p">(</span><span class="n">targets</span><span class="p">[</span><span class="n">test_indices</span><span class="p">],</span> <span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="citation">
<h2>Citation<a class="headerlink" href="#citation" title="Permalink to this heading"></a></h2>
<p>Please cite the use of ChemML as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@article</span><span class="p">{</span><span class="n">Afzal2018a</span><span class="p">,</span>
<span class="n">author</span> <span class="o">=</span> <span class="p">{</span><span class="n">Afzal</span><span class="p">,</span> <span class="n">Mohammad</span> <span class="n">Atif</span> <span class="n">Faiz</span> <span class="ow">and</span> <span class="n">Cheng</span><span class="p">,</span> <span class="n">Chong</span> <span class="ow">and</span> <span class="n">Hachmann</span><span class="p">,</span> <span class="n">Johannes</span><span class="p">},</span>
<span class="n">doi</span> <span class="o">=</span> <span class="p">{</span><span class="mf">10.1063</span><span class="o">/</span><span class="mf">1.5007873</span><span class="p">},</span>
<span class="n">journal</span> <span class="o">=</span> <span class="p">{</span><span class="n">The</span> <span class="n">Journal</span> <span class="n">of</span> <span class="n">Chemical</span> <span class="n">Physics</span><span class="p">},</span>
<span class="n">number</span> <span class="o">=</span> <span class="p">{</span><span class="mi">24</span><span class="p">},</span>
<span class="n">pages</span> <span class="o">=</span> <span class="p">{</span><span class="mi">241712</span><span class="p">},</span>
<span class="n">title</span> <span class="o">=</span> <span class="p">{{</span><span class="n">Combining</span> <span class="n">first</span><span class="o">-</span><span class="n">principles</span> <span class="ow">and</span> <span class="n">data</span> <span class="n">modeling</span> <span class="k">for</span> <span class="n">the</span> <span class="n">accurate</span> <span class="n">prediction</span> <span class="n">of</span> <span class="n">the</span> <span class="n">refractive</span> <span class="n">index</span> <span class="n">of</span> <span class="n">organic</span> <span class="n">polymers</span><span class="p">}},</span>
<span class="n">volume</span> <span class="o">=</span> <span class="p">{</span><span class="mi">148</span><span class="p">},</span>
<span class="n">year</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2018</span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@article</span><span class="p">{</span><span class="n">Afzal2019d</span><span class="p">,</span>
<span class="n">title</span><span class="o">=</span><span class="p">{</span><span class="n">A</span> <span class="n">deep</span> <span class="n">neural</span> <span class="n">network</span> <span class="n">model</span> <span class="k">for</span> <span class="n">packing</span> <span class="n">density</span> <span class="n">predictions</span> <span class="ow">and</span> <span class="n">its</span> <span class="n">application</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">study</span> <span class="n">of</span> <span class="mf">1.5</span> <span class="n">million</span> <span class="n">organic</span> <span class="n">molecules</span><span class="p">},</span>
<span class="n">author</span><span class="o">=</span><span class="p">{</span><span class="n">Afzal</span><span class="p">,</span> <span class="n">Mohammad</span> <span class="n">Atif</span> <span class="n">Faiz</span> <span class="ow">and</span> <span class="n">Sonpal</span><span class="p">,</span> <span class="n">Aditya</span> <span class="ow">and</span> <span class="n">Haghighatlari</span><span class="p">,</span> <span class="n">Mojtaba</span> <span class="ow">and</span> <span class="n">Schultz</span><span class="p">,</span> <span class="n">Andrew</span> <span class="n">J</span> <span class="ow">and</span> <span class="n">Hachmann</span><span class="p">,</span> <span class="n">Johannes</span><span class="p">},</span>
<span class="n">journal</span><span class="o">=</span><span class="p">{</span><span class="n">Chemical</span> <span class="n">science</span><span class="p">},</span>
<span class="n">volume</span><span class="o">=</span><span class="p">{</span><span class="mi">10</span><span class="p">},</span>
<span class="n">number</span><span class="o">=</span><span class="p">{</span><span class="mi">36</span><span class="p">},</span>
<span class="n">pages</span><span class="o">=</span><span class="p">{</span><span class="mi">8374</span><span class="o">--</span><span class="mi">8383</span><span class="p">},</span>
<span class="n">year</span><span class="o">=</span><span class="p">{</span><span class="mi">2019</span><span class="p">},</span>
<span class="n">publisher</span><span class="o">=</span><span class="p">{</span><span class="n">Royal</span> <span class="n">Society</span> <span class="n">of</span> <span class="n">Chemistry</span><span class="p">}</span>
<span class="p">}</span>


<span class="nd">@article</span><span class="p">{</span><span class="n">Afzal2019a</span><span class="p">,</span>
<span class="n">author</span> <span class="o">=</span> <span class="p">{</span><span class="n">Afzal</span><span class="p">,</span> <span class="n">Mohammad</span> <span class="n">Atif</span> <span class="n">Faiz</span> <span class="ow">and</span> <span class="n">Hachmann</span><span class="p">,</span> <span class="n">Johannes</span><span class="p">},</span>
<span class="n">doi</span> <span class="o">=</span> <span class="p">{</span><span class="mf">10.1039</span><span class="o">/</span><span class="n">c8cp05492d</span><span class="p">},</span>
<span class="n">issn</span> <span class="o">=</span> <span class="p">{</span><span class="mi">14639076</span><span class="p">},</span>
<span class="n">journal</span> <span class="o">=</span> <span class="p">{</span><span class="n">Physical</span> <span class="n">Chemistry</span> <span class="n">Chemical</span> <span class="n">Physics</span><span class="p">},</span>
<span class="n">number</span> <span class="o">=</span> <span class="p">{</span><span class="mi">8</span><span class="p">},</span>
<span class="n">pages</span> <span class="o">=</span> <span class="p">{</span><span class="mi">4452</span><span class="o">--</span><span class="mi">4460</span><span class="p">},</span>
<span class="n">publisher</span> <span class="o">=</span> <span class="p">{</span><span class="n">Royal</span> <span class="n">Society</span> <span class="n">of</span> <span class="n">Chemistry</span><span class="p">},</span>
<span class="n">title</span> <span class="o">=</span> <span class="p">{{</span><span class="n">Benchmarking</span> <span class="n">DFT</span> <span class="n">approaches</span> <span class="k">for</span> <span class="n">the</span> <span class="n">calculation</span> <span class="n">of</span> <span class="n">polarizability</span> <span class="n">inputs</span> <span class="k">for</span> <span class="n">refractive</span> <span class="n">index</span> <span class="n">predictions</span> <span class="ow">in</span> <span class="n">organic</span> <span class="n">polymers</span><span class="p">}},</span>
<span class="n">volume</span> <span class="o">=</span> <span class="p">{</span><span class="mi">21</span><span class="p">},</span>
<span class="n">year</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2019</span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@article</span><span class="p">{</span><span class="n">Afzal2019b</span><span class="p">,</span>
<span class="n">author</span> <span class="o">=</span> <span class="p">{</span><span class="n">Afzal</span><span class="p">,</span> <span class="n">Mohammad</span> <span class="n">Atif</span> <span class="n">Faiz</span> <span class="ow">and</span> <span class="n">Haghighatlari</span><span class="p">,</span> <span class="n">Mojtaba</span> <span class="ow">and</span> <span class="p">{</span><span class="n">Prasad</span> <span class="n">Ganesh</span><span class="p">},</span> <span class="n">Sai</span> <span class="ow">and</span> <span class="n">Cheng</span><span class="p">,</span> <span class="n">Chong</span> <span class="ow">and</span> <span class="n">Hachmann</span><span class="p">,</span> <span class="n">Johannes</span><span class="p">},</span>
<span class="n">issn</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1932</span><span class="o">-</span><span class="mi">7447</span><span class="p">},</span>
<span class="n">journal</span> <span class="o">=</span> <span class="p">{</span><span class="n">The</span> <span class="n">Journal</span> <span class="n">of</span> <span class="n">Physical</span> <span class="n">Chemistry</span> <span class="n">C</span><span class="p">},</span>
<span class="n">pages</span> <span class="o">=</span> <span class="p">{</span><span class="mi">14610</span><span class="o">--</span><span class="mi">14618</span><span class="p">},</span>
<span class="n">publisher</span> <span class="o">=</span> <span class="p">{</span><span class="n">American</span> <span class="n">Chemical</span> <span class="n">Society</span><span class="p">},</span>
<span class="n">title</span> <span class="o">=</span> <span class="p">{{</span> <span class="n">Accelerated</span> <span class="n">Discovery</span> <span class="n">of</span> <span class="n">High</span><span class="o">-</span><span class="n">Refractive</span><span class="o">-</span><span class="n">Index</span> <span class="n">Polyimides</span> <span class="n">via</span> <span class="n">First</span><span class="o">-</span><span class="n">Principles</span> <span class="n">Molecular</span> <span class="n">Modeling</span><span class="p">,</span> <span class="n">Virtual</span> <span class="n">High</span><span class="o">-</span><span class="n">Throughput</span> <span class="n">Screening</span><span class="p">,</span> <span class="ow">and</span> <span class="n">Data</span> <span class="n">Mining</span> <span class="p">}},</span>
<span class="n">volume</span> <span class="o">=</span> <span class="p">{</span><span class="mi">123</span><span class="p">},</span>
<span class="n">year</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2019</span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@article</span><span class="p">{</span><span class="n">vishwakarma2019towards</span><span class="p">,</span>
<span class="n">title</span><span class="o">=</span><span class="p">{</span><span class="n">Towards</span> <span class="n">autonomous</span> <span class="n">machine</span> <span class="n">learning</span> <span class="ow">in</span> <span class="n">chemistry</span> <span class="n">via</span> <span class="n">evolutionary</span> <span class="n">algorithms</span><span class="p">},</span>
<span class="n">author</span><span class="o">=</span><span class="p">{</span><span class="n">Vishwakarma</span><span class="p">,</span> <span class="n">Gaurav</span> <span class="ow">and</span> <span class="n">Haghighatlari</span><span class="p">,</span> <span class="n">Mojtaba</span> <span class="ow">and</span> <span class="n">Hachmann</span><span class="p">,</span> <span class="n">Johannes</span><span class="p">},</span>
<span class="n">journal</span><span class="o">=</span><span class="p">{</span><span class="n">ChemRxiv</span> <span class="n">preprint</span><span class="p">},</span>
<span class="n">year</span><span class="o">=</span><span class="p">{</span><span class="mi">2019</span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@phdthesis</span><span class="p">{</span><span class="n">atif_thesis</span><span class="p">,</span>
<span class="n">author</span>       <span class="o">=</span> <span class="p">{</span><span class="n">Afzal</span><span class="p">,</span> <span class="n">Mohammad</span> <span class="n">Atif</span> <span class="n">Faiz</span><span class="p">},</span>
<span class="n">title</span>        <span class="o">=</span> <span class="p">{</span><span class="n">From</span> <span class="n">virtual</span> <span class="n">high</span><span class="o">-</span><span class="n">throughput</span> <span class="n">screening</span> <span class="ow">and</span> <span class="n">machine</span> <span class="n">learning</span> <span class="n">to</span> <span class="n">the</span> <span class="n">discovery</span> <span class="ow">and</span> <span class="n">rational</span> <span class="n">design</span> <span class="n">of</span> <span class="n">polymers</span> <span class="k">for</span> <span class="n">optical</span> <span class="n">applications</span><span class="p">},</span>
<span class="n">school</span>       <span class="o">=</span> <span class="p">{</span><span class="n">University</span> <span class="n">at</span> <span class="n">Buffalo</span><span class="p">},</span>
<span class="n">year</span>         <span class="o">=</span> <span class="p">{</span><span class="mi">2018</span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@mastersthesis</span><span class="p">{</span><span class="n">gaurav_msthesis</span><span class="p">,</span>
<span class="n">author</span> <span class="o">=</span> <span class="p">{</span><span class="n">Vishwakarma</span><span class="p">,</span> <span class="n">Gaurav</span><span class="p">},</span>
<span class="n">school</span> <span class="o">=</span> <span class="p">{</span><span class="n">University</span> <span class="n">at</span> <span class="n">Buffalo</span><span class="p">},</span>
<span class="n">title</span> <span class="o">=</span> <span class="p">{{</span><span class="n">Machine</span> <span class="n">Learning</span> <span class="n">Model</span> <span class="n">Selection</span> <span class="k">for</span> <span class="n">Predicting</span> <span class="n">Properties</span> <span class="n">of</span> <span class="n">High</span><span class="o">-</span><span class="n">Refractive</span><span class="o">-</span><span class="n">Index</span> <span class="n">Polymers</span><span class="p">}},</span>
<span class="n">year</span> <span class="o">=</span> <span class="p">{</span><span class="mi">2018</span><span class="p">}</span>
<span class="p">}</span>

<span class="nd">@article</span><span class="p">{</span><span class="n">vishwakarma2021metrics</span><span class="p">,</span>
<span class="n">title</span><span class="o">=</span><span class="p">{</span><span class="n">Metrics</span> <span class="k">for</span> <span class="n">Benchmarking</span> <span class="ow">and</span> <span class="n">Uncertainty</span> <span class="n">Quantification</span><span class="p">:</span> <span class="n">Quality</span><span class="p">,</span> <span class="n">Applicability</span><span class="p">,</span> <span class="ow">and</span> <span class="n">Best</span> <span class="n">Practices</span> <span class="k">for</span> <span class="n">Machine</span> <span class="n">Learning</span> <span class="ow">in</span> <span class="n">Chemistry</span><span class="p">},</span>
<span class="n">author</span><span class="o">=</span><span class="p">{</span><span class="n">Vishwakarma</span><span class="p">,</span> <span class="n">Gaurav</span> <span class="ow">and</span> <span class="n">Sonpal</span><span class="p">,</span> <span class="n">Aditya</span> <span class="ow">and</span> <span class="n">Hachmann</span><span class="p">,</span> <span class="n">Johannes</span><span class="p">},</span>
<span class="n">journal</span><span class="o">=</span><span class="p">{</span><span class="n">Trends</span> <span class="ow">in</span> <span class="n">Chemistry</span><span class="p">},</span>
<span class="n">year</span><span class="o">=</span><span class="p">{</span><span class="mi">2021</span><span class="p">},</span>
<span class="n">publisher</span><span class="o">=</span><span class="p">{</span><span class="n">Cell</span> <span class="n">Press</span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="Published" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../API/index.html" class="btn btn-neutral float-right" title="ChemML API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2014-2022 Johannes Hachmann, Mojtaba Haghighatlari, Aditya Sonpal, Gaurav Vishwakarma and Aatish Pradhan.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>